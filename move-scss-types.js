const fs = require("fs");
const path = require("path");

// Define the source and destination directories
const srcDir = path.join(__dirname, "src"); // Change this path to where your SCSS files are located
const destDir = path.join(__dirname, "src/types"); // Directory to move the .d.ts files

// Ensure the destination directory exists
if (!fs.existsSync(destDir)) {
  fs.mkdirSync(destDir, { recursive: true });
  console.log(`Created destination folder: ${destDir}`);
}

// Function to move .d.ts files generated by typed-scss-modules
const moveTypes = (dir) => {
  fs.readdirSync(dir, { withFileTypes: true }).forEach((entry) => {
    const fullPath = path.join(dir, entry.name);

    // If the entry is a directory, recursively search it
    if (entry.isDirectory()) {
      moveTypes(fullPath);
    }
    // If it's a .d.ts file generated by typed-scss-modules
    else if (entry.isFile() && entry.name.endsWith(".scss.d.ts")) {
      const destPath = path.join(destDir, entry.name);

      // Move the .d.ts file to the destination
      try {
        fs.renameSync(fullPath, destPath);
        console.log(`Moved: ${entry.name} from ${fullPath} to ${destPath}`);
      } catch (error) {
        console.error(`Failed to move ${entry.name}:`, error);
      }
    }
  });
};

// Start moving files from the source directory
moveTypes(srcDir);
